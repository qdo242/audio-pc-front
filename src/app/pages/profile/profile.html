<div class="profile-page">
  <div class="container">
    <div class="profile-layout">

      <app-account-sidebar [activePage]="activeTab"></app-account-sidebar>

      <main class="profile-content">

        @if (activeTab === 'profile') {
          <div class="profile-tab">
            <h1 class="page-title">H·ªì s∆° c·ªßa t√¥i</h1>
            <p class="page-subtitle">Qu·∫£n l√Ω th√¥ng tin c√° nh√¢n c·ªßa b·∫°n ƒë·ªÉ b·∫£o m·∫≠t t√†i kho·∫£n.</p>
            <form (ngSubmit)="onUpdateProfile()" class="profile-form">
               <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" [value]="authService.userEmail" class="form-input" readonly disabled>
              </div>
              <div class="form-group">
                <label for="name">H·ªç v√† t√™n *</label>
                <input type="text" id="name" [(ngModel)]="profileData.name" name="name" class="form-input" required>
              </div>
              <div class="form-group">
                <label for="phone">S·ªë ƒëi·ªán tho·∫°i *</label>
                <input type="tel" id="phone" [(ngModel)]="profileData.phone" name="phone" class="form-input" required>
              </div>
              <div class="form-group">
                <label for="address">ƒê·ªãa ch·ªâ *</label>
                <input type="text" id="address" [(ngModel)]="profileData.address" name="address" class="form-input" required>
              </div>

              @if (profileMessage) { <div class="message success">{{ profileMessage }}</div> }
              @if (profileError) { <div class="message error">{{ profileError }}</div> }

              <div class="form-actions">
                <button type="submit" class="btn btn-primary" [disabled]="isLoadingProfile">
                  {{ isLoadingProfile ? 'ƒêang l∆∞u...' : 'L∆∞u thay ƒë·ªïi' }}
                </button>
              </div>
            </form>
          </div>
        }

        @if (activeTab === 'password') {
          <div class="password-tab">
            <h1 class="page-title">ƒê·ªïi m·∫≠t kh·∫©u</h1>
            <p class="page-subtitle">ƒê·ªÉ b·∫£o m·∫≠t, vui l√≤ng kh√¥ng chia s·∫ª m·∫≠t kh·∫©u cho ng∆∞·ªùi kh√°c.</p>
            <form (ngSubmit)="onChangePassword()" class="profile-form">
               <div class="form-group">
                <label for="currentPassword">M·∫≠t kh·∫©u hi·ªán t·∫°i *</label>
                <input type="password" id="currentPassword" [(ngModel)]="passwordData.currentPassword" name="currentPassword" class="form-input" required>
              </div>
              <div class="form-group">
                <label for="newPassword">M·∫≠t kh·∫©u m·ªõi *</label>
                <input type="password" id="newPassword" [(ngModel)]="passwordData.newPassword" name="newPassword" class="form-input" required>
              </div>
              <div class="form-group">
                <label for="confirmPassword">X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi *</label>
                <input type="password" id="confirmPassword" [(ngModel)]="passwordData.confirmPassword" name="confirmPassword" class="form-input" required>
              </div>

              @if (passwordMessage) { <div class="message success">{{ passwordMessage }}</div> }
              @if (passwordError) { <div class="message error">{{ passwordError }}</div> }

              <div class="form-actions">
                <button type="submit" class="btn btn-primary" [disabled]="isLoadingPassword">
                  {{ isLoadingPassword ? 'ƒêang ƒë·ªïi...' : 'ƒê·ªïi m·∫≠t kh·∫©u' }}
                </button>
              </div>
            </form>
          </div>
        }

        @if (activeTab === 'wishlist') {
          <div class="wishlist-tab">
            <h1 class="page-title">Danh s√°ch y√™u th√≠ch</h1>
            <p class="page-subtitle">Nh·ªØng s·∫£n ph·∫©m b·∫°n ƒëang quan t√¢m.</p>

            @if (isLoadingWishlist) {
              <div class="loading-state" style="text-align: center; padding: 2rem;">
                <div class="loading-spinner"></div>
                <p>ƒêang t·∫£i...</p>
              </div>
            } @else {
              @if (wishlistProducts.length > 0) {
                <div class="wishlist-grid">
                  @for (product of wishlistProducts; track product.id) {
                    <div class="wishlist-item-wrapper">
                      <app-product-card
                        [product]="product"
                        (wishlistChanged)="onWishlistChanged()">
                      </app-product-card>
                    </div>
                  }
                </div>
              } @else {
                <div class="empty-state" style="text-align: center; padding: 3rem;">
                  <div class="empty-icon" style="font-size: 3rem; margin-bottom: 1rem;">üíî</div>
                  <h3>Danh s√°ch tr·ªëng</h3>
                  <p>B·∫°n ch∆∞a th√™m s·∫£n ph·∫©m n√†o v√†o danh s√°ch y√™u th√≠ch.</p>
                  <a routerLink="/products" class="btn btn-primary" style="margin-top: 1rem;">Kh√°m ph√° ngay</a>
                </div>
              }
            }
          </div>
        }

      </main>
    </div>
  </div>
</div>
