<div class="profile-page">
  <div class="container">
    <div class="profile-layout">
      
      <app-account-sidebar [activePage]="'orders'"></app-account-sidebar>

      <main class="profile-content">
        <div class="order-history-tab">
          <h1 class="page-title">L·ªãch s·ª≠ ƒë∆°n h√†ng</h1>
          <p class="page-subtitle">Theo d√µi t·∫•t c·∫£ c√°c ƒë∆°n h√†ng ƒë√£ ƒë·∫∑t c·ªßa b·∫°n t·∫°i ƒë√¢y.</p>

          @if (isLoading) {
            <div class="loading-state">
              <div class="loading-spinner"></div>
              <p>ƒêang t·∫£i l·ªãch s·ª≠ ƒë∆°n h√†ng...</p>
            </div>
          } @else {
            @if (orders.length > 0) {
              <div class="order-list">
                
                @for (order of orders; track order.id) {
                  <div class="order-card">
                    <div class="order-header">
                      <div class="order-id-date">
                        <strong class="order-id">Ng√†y ƒë·∫∑t: {{ order.createdAt | date:'dd/MM/yyyy HH:mm' }}</strong>
                      </div>
                      <div class="order-status">
                        <span class="status-badge" [ngClass]="getStatusClass(order.status)">
                          {{ getStatusText(order.status) }}
                        </span>
                      </div>
                    </div>
                    
                    <div class="order-items-list">
                      @for (item of order.items; track item.productId) {
                        <div class="order-item">
                          
                          <img [src]="getFullImageUrl(item.image)" alt="{{ item.productName }}" class="item-image">
                          
                          <div class="item-info">
                            <span class="item-name">{{ item.productName }}</span>
                            </div>
                          <div class="item-price-qty">
                            <span class="item-price">{{ item.price | number }}‚Ç´</span>
                            <span class="item-qty">x {{ item.quantity }}</span>
                          </div>
                          <div class="item-total">
                            {{ (item.price * item.quantity) | number }}‚Ç´
                          </div>
                        </div>
                      }
                    </div>

                    <div class="order-footer">
                      <span class="order-total-label">T·ªïng ti·ªÅn:</span>
                      <span class="order-total-amount">{{ order.totalAmount | number }}‚Ç´</span>
                      
                      @if (order.status === 'PENDING') {
                        <button class="btn btn-danger btn-small" (click)="cancelOrder(order.id)">
                          H·ªßy ƒë∆°n
                        </button>
                      }
                      
                      <a [routerLink]="['/orders', order.id]" class="btn btn-secondary btn-small">Xem chi ti·∫øt</a>
                    </div>
                    </div>
                }
              </div>
            } @else {
              <div class="empty-state">
                <div class="empty-icon">üì¶</div>
                <h2>Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o</h2>
                <p>B·∫°n ch∆∞a ƒë·∫∑t ƒë∆°n h√†ng n√†o. H√£y b·∫Øt ƒë·∫ßu mua s·∫Øm!</p>
                <a routerLink="/products" class="btn btn-primary">B·∫Øt ƒë·∫ßu mua s·∫Øm</a>
              </div>
            }
          }
        </div>
      </main>
    </div>
  </div>
</div>